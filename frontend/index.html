<script>
  const API_BASE = "https://youtube-ai-search.onrender.com"; // ← あなたのRender URLに変更

  async function search() {
    const query = document.getElementById("searchInput").value;
    if (!query) return;

    try {
      const res = await fetch(`${API_BASE}/search?query=${encodeURIComponent(query)}`);
      const data = await res.json();

      const results = document.getElementById("results");
      results.innerHTML = '';

      if (data.length === 0) {
        results.innerHTML = '<p>動画が見つかりませんでした。</p>';
        return;
      }

      data.forEach(video => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${video.thumbnail}" alt="thumbnail">
          <div class="card-body">
            <a href="${video.url}" target="_blank">${video.title}</a>
            <p>${video.description}</p>
          </div>
        `;
        results.appendChild(card);
      });
    } catch (error) {
      console.error("検索エラー:", error);
      alert("検索に失敗しました。");
    }
  }

  // 入力で自動検索
  document.getElementById("searchInput").addEventListener("input", () => {
    const val = document.getElementById("searchInput").value;
    if (val.length >= 2) {
      search();
    }
  });
</script>
